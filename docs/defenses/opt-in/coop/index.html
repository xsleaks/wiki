<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Getting access to a website&rsquo;s window object is a common prerequisite for different XS-Leak techniques. Framing Protections can ensure that an attacker cannot use iframes to access the window object, but this does not stop an attacker from accessing the window object from an opened window through window.open(url) or window.opener references.
Exploiting XS-Leaks with window.open is generally seen as the least appealing option for an attacker because the user can see it happen in the open browser window."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Cross-Origin-Opener-Policy"><meta property="og:description" content="Getting access to a website&rsquo;s window object is a common prerequisite for different XS-Leak techniques. Framing Protections can ensure that an attacker cannot use iframes to access the window object, but this does not stop an attacker from accessing the window object from an opened window through window.open(url) or window.opener references.
Exploiting XS-Leaks with window.open is generally seen as the least appealing option for an attacker because the user can see it happen in the open browser window."><meta property="og:type" content="article"><meta property="og:url" content="https://xsleaks.dev/docs/defenses/opt-in/coop/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2020-10-01T00:00:00+00:00"><meta property="article:modified_time" content="2020-11-06T16:40:10+01:00"><title>Cross-Origin-Opener-Policy | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.1c9a9009be3c645cbccbe64eb0a90e28621e4118971d9a502db4aaa9bec96cfc.css integrity="sha256-HJqQCb48ZFy8y+ZOsKkOKGIeQRiXHZpQLbSqqb7JbPw="><script defer src=/en.search.min.964301f621aa07f70e94cbce2ee6ea78c0d4b7b4cd883b2f518b8bfe29f1d7ab.js integrity="sha256-lkMB9iGqB/cOlMvOLubqeMDUt7TNiDsvUYuL/inx16s="></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Attacks</span><ul><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/window-references/>Window References</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><span>Browser Features</span><ul><li><a href=/docs/attacks/browser-features/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/browser-features/corp/>CORP Leaks</a></li></ul></li><li><span>Timing Attacks</span><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li><li><a href=/docs/attacks/timing-attacks/performance-api/>Performance API</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li></ul></li><li><a href=/docs/attacks/experiments/ class=collapsed>Experiments</a></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><a href=/docs/defenses/design-protections/>Application Design</a><ul><li><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></li><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><a href=/docs/defenses/opt-in/>Opt-In Mechanisms</a><ul><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/coop/ class=active>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>SameSite Cookies</a></li></ul></li><li><a href=/docs/defenses/isolation-policies/>Isolation Policies</a><ul><li><a href=/docs/defenses/isolation-policies/resource-isolation/>Resource Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/framing-isolation/>Framing Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/navigation-isolation/>Navigation Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/strict-isolation/>Strict Isolation Policy</a></li></ul></li><li><a href=/docs/defenses/secure-defaults/>Secure Defaults</a><ul><li><a href=/docs/defenses/secure-defaults/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/secure-defaults/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li></ul></li><li class=book-section-flat><a href=/docs/contributions/>Contributions</a><ul></ul></li></ul></nav><script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Cross-Origin-Opener-Policy</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#considerations>Considerations</a></li><li><a href=#deployment>Deployment</a></li><li><a href=#references>References</a></li></ul></nav></aside></header><article class=markdown><h1>Cross-Origin-Opener-Policy</h1><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p><p>Getting access to a website&rsquo;s <code>window</code> object is a common prerequisite for different XS-Leak techniques. <a href=https://xsleaks.dev/docs/defenses/opt-in/xfo/>Framing Protections</a> can ensure that an attacker cannot use iframes to access the <code>window</code> object, but this does not stop an attacker from accessing the <code>window</code> object from an opened window through <code>window.open(url)</code> or <code>window.opener</code> references.</p><p>Exploiting XS-Leaks with <code>window.open</code> is generally seen as the least appealing option for an attacker because the user can see it happen in the open browser window. However, it&rsquo;s usually the right technique when:</p><ul><li>A page sets <a href=https://xsleaks.dev/docs/defenses/opt-in/xfo/>Framing Protections</a>.</li><li>A page sets <a href=https://xsleaks.dev/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies with <code>Lax</code> Mode</a> (in contrast to the <code>Strict</code> mode, navigating a top-level window is allowed by the <code>Lax</code> mode).</li></ul><p>To prevent other websites from gaining arbitrary window references to a page, applications can deploy Cross-Origin-Opener-Policy (COOP) <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>There are three possible values for the COOP header:</p><ul><li><code>unsafe-none</code> – This is the default value and is how websites behave if no value is set.</li><li><code>same-origin</code> – This is the strictest value. If you set <code>same-origin</code>, then cross-origin websites cannot get access to your <code>window</code> object through opening new windows. If your application relies on using <code>window.open</code> to open another website and communicate with it, this will be blocked by <code>same-origin</code>. If this is an issue, set <code>same-origin-allow-popups</code> instead.</li><li><code>same-origin-allow-popups</code> – This value allows your website to use <code>window.open</code>, but does not allow other websites to use <code>window.open</code> against your application.</li></ul><p>If possible, it is recommended to set <code>same-origin</code>. If you set <code>same-origin-allow-popups</code>, be sure to review what websites you open with <code>window.open</code> and ensure that they are trusted.</p><h2 id=considerations>Considerations
<a class=anchor href=#considerations>#</a></h2><p>Since COOP is an opt-in mechanism and a very recent one, it can easily be overlooked by developers and security engineers. Nonetheless, it’s important to highlight the importance of this defense mechanism as it is the only way to prevent attackers from exploiting XS-Leaks which make use of window references returned by APIs like <code>window.open</code> (unless SameSite Cookies in the <code>Strict</code> mode can be widely deployed).</p><h2 id=deployment>Deployment
<a class=anchor href=#deployment>#</a></h2><p>Check out this <a href=https://web.dev/why-coop-coep/>web.dev</a> article to learn more about the advantages of this protection and how to deploy it.</p><h2 id=references>References
<a class=anchor href=#references>#</a></h2><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Cross-Origin-Opener-Policy response header (also known as COOP), <a href=https://gist.github.com/annevk/6f2dd8c79c77123f39797f6bdac43f3e>link</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Cross-Origin-Opener-Policy, <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy>link</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/commit/eae96d23a6602a5b0e62b8dac9beba9f0b014267 title="Last modified by goedi02 | November 6, 2020" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Last Modified: November 6, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/edit/master/content//docs/defenses/opt-in/coop.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this article</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#considerations>Considerations</a></li><li><a href=#deployment>Deployment</a></li><li><a href=#references>References</a></li></ul></nav></aside></main></body></html>
<!doctype html><html lang=en dir=ZgotmplZ><head><meta name=generator content="Hugo 0.147.6"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  XS-Leaks Wiki
  #


  Overview
  #

Cross-site leaks (aka XS-Leaks, XSLeaks) are a class of vulnerabilities derived from side-channels 1 built into the web platform. They take advantage of the web&rsquo;s core principle of composability, which allows websites to interact with each other, and abuse legitimate mechanisms 2 to infer information about the user. One way of looking at XS-Leaks is to highlight their similarity with cross-site request forgery (CSRF 3) techniques, with the main difference being that instead of allowing other websites to perform actions on behalf of a user, XS-Leaks can be used to infer information about a user."><meta name=theme-color content="#FFFFFF"><meta property="og:url" content="https://xsleaks.dev/"><meta property="og:site_name" content="XS-Leaks Wiki"><meta property="og:title" content="Introduction"><meta property="og:description" content="XS-Leaks Wiki # Overview # Cross-site leaks (aka XS-Leaks, XSLeaks) are a class of vulnerabilities derived from side-channels 1 built into the web platform. They take advantage of the webâ€™s core principle of composability, which allows websites to interact with each other, and abuse legitimate mechanisms 2 to infer information about the user. One way of looking at XS-Leaks is to highlight their similarity with cross-site request forgery (CSRF 3) techniques, with the main difference being that instead of allowing other websites to perform actions on behalf of a user, XS-Leaks can be used to infer information about a user."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Introduction | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.3e4293c95aca96b4ee60e121777d22919987757ee0af31973de12f0294bb3e38.css integrity="sha256-PkKTyVrKlrTuYOEhd30ikZmHdX7grzGXPeEvApS7Pjg="><script defer src=/en.search.min.221adc676e09b996f204295099466eb180b67277c164a32aa536a14d37fdfc4d.js integrity="sha256-IhrcZ24JuZbyBClQmUZusYC2cnfBZKMqpTahTTf9/E0="></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk="></script><link rel=alternate type=application/rss+xml href=https://xsleaks.dev/index.xml title="XS-Leaks Wiki"></head><body dir=ZgotmplZ><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Attacks</span><ul><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/window-references/>Window References</a></li><li><a href=/docs/attacks/css-tricks/>CSS Tricks</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li><li><a href=/docs/attacks/element-leaks/>Element leaks</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><span>Browser Features</span><ul><li><a href=/docs/attacks/browser-features/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/browser-features/corp/>CORP Leaks</a></li></ul></li><li><span>Timing Attacks</span><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li><li><a href=/docs/attacks/timing-attacks/performance-api/>Performance API</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li></ul></li><li><a href=/docs/attacks/experiments/ class=collapsed>Experiments</a></li><li><a href=/docs/attacks/css-injection/>CSS Injection</a></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><a href=/docs/defenses/design-protections/>Application Design</a><ul><li><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></li><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><a href=/docs/defenses/opt-in/>Opt-In Mechanisms</a><ul><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>SameSite Cookies</a></li><li><a href=/docs/defenses/opt-in/document-policies/>Document Policies</a></li></ul></li><li><a href=/docs/defenses/isolation-policies/>Isolation Policies</a><ul><li><a href=/docs/defenses/isolation-policies/resource-isolation/>Resource Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/framing-isolation/>Framing Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/navigation-isolation/>Navigation Isolation Policy</a></li><li><a href=/docs/defenses/isolation-policies/strict-isolation/>Strict Isolation Policy</a></li></ul></li><li><a href=/docs/defenses/secure-defaults/>Secure Defaults</a><ul><li><a href=/docs/defenses/secure-defaults/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/secure-defaults/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li></ul></li><li class=book-section-flat><a href=/docs/contributions/>Contributions</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Introduction</strong>
<label for=toc-control></label></div></header><article class=markdown><h1 id=xs-leaks-wiki>XS-Leaks Wiki
<a class=anchor href=#xs-leaks-wiki>#</a></h1><h2 id=overview>Overview
<a class=anchor href=#overview>#</a></h2><p>Cross-site leaks (aka XS-Leaks, XSLeaks) are a class of vulnerabilities derived from side-channels <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> built into the web platform. They take advantage of the web&rsquo;s core principle of composability, which allows websites to interact with each other, and abuse legitimate mechanisms <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> to infer information about the user. One way of looking at XS-Leaks is to highlight their similarity with cross-site request forgery (CSRF <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>) techniques, with the main difference being that instead of allowing other websites to perform actions on behalf of a user, XS-Leaks can be used to infer information about a user.</p><p>Browsers provide a wide variety of features to support interactions between different web applications; for example, they permit a website to load subresources, navigate, or send messages to another application. While such behaviors are generally constrained by security mechanisms built into the web platform (e.g. the <a href=https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy>same-origin policy</a>), XS-Leaks take advantage of small pieces of information which are exposed during interactions between websites.</p><p>The principle of an XS-Leak is to use such side-channels available on the web to reveal sensitive information about users, such as their data in other web applications, details about their local environment, or internal networks they are connected to.</p><h2 id=cross-site-oracles>Cross-site oracles
<a class=anchor href=#cross-site-oracles>#</a></h2><p>The pieces of information used for an XS-Leak usually have a binary form and are referred to as &ldquo;oracles&rdquo;. Oracles generally answer with <em>YES</em> or <em>NO</em> to cleverly prepared questions in a way that is visible to an attacker. For example, an oracle can be asked:</p><blockquote><p>Does the word <em>secret</em> appear in the user&rsquo;s search results in another web application?</p></blockquote><p>This question might be equivalent to asking:</p><blockquote><p>Does the query <em>?query=secret</em> return an <em>HTTP 200</em> status code?</p></blockquote><p>Since it is possible to detect the <em>HTTP 200</em> status code with <a href=https://xsleaks.dev/docs/attacks/error-events/>Error Events</a>, this has the same effect as asking:</p><blockquote><p>Does loading a resource from <em>?query=secret</em> in the application trigger the <em>onload</em> event?</p></blockquote><p>The above query could be repeated by an attacker for many different keywords, and as a result the answers could be used to infer sensitive information about the user&rsquo;s data.</p><p>Browsers provide a wide range of different APIs that, while well-intended, can end up leaking small amounts of cross-origin information. They are described in detail throughout this wiki.</p><h2 id=example>Example
<a class=anchor href=#example>#</a></h2><p>Websites are not allowed to directly access data on other websites, but they can load resources from them and observe the side effects. For example, <em>evil.com</em> is forbidden from explicitly reading a response from <em>bank.com</em>, but <em>evil.com</em> can attempt to load a script from <em>bank.com</em> and determine whether or not it successfully loaded.</p><blockquote class="book-hint2 example"><p class="hint-title example"><svg class="book-icon"><use href="/svg/hint-icons.svg#example-notice"/></svg><span>example</span></p><p>Suppose that <em>bank.com</em> has an API endpoint that returns data about a user&rsquo;s receipt for a given type of transaction.</p><ol><li><em>evil.com</em> can attempt to load the URL <em>bank.com/my_receipt?q=groceries</em> as a script. By default, the browser attaches cookies when loading resources, so the request to <em>bank.com</em> will carry the user&rsquo;s credentials.</li><li>If the user has recently bought groceries, the script loads successfully with an <em>HTTP 200</em> status code. If the user hasn&rsquo;t bought groceries, the request fails to load with an <em>HTTP 404</em> status code, which triggers an <a href=https://xsleaks.dev/docs/attacks/error-events/>Error Event</a>.</li><li>By listening to the error event and repeating this approach with different queries, the attacker can infer a significant amount of information about the user&rsquo;s transaction history.</li></ol></blockquote><p>In the example above, two websites of two different origins (<em>evil.com</em> and <em>bank.com</em>) interacted through an API that browsers allow websites to use. This interaction didn&rsquo;t exploit any vulnerabilities in the browser or in <em>bank.com</em>, but it still allowed <em>evil.com</em> to gain information about the user&rsquo;s data on <em>bank.com</em>.Â Â </p><h2 id=root-cause-of-xs-leaks>Root cause of XS-Leaks
<a class=anchor href=#root-cause-of-xs-leaks>#</a></h2><p>The root cause of most XS-Leaks is inherent to the design of the web. Oftentimes applications are vulnerable to some cross-site information leaks without having done anything wrong. It is challenging to fix the root cause of XS-Leaks at the browser level because in many cases doing so would break existing websites. For this reason, browsers are now implementing various <a href=https://xsleaks.dev/defenses/>Defense Mechanisms</a> to overcome these difficulties. Many of these defenses require websites to opt in to a more restrictive security model, usually through the use of certain HTTP headers (e.g. <em><a href=https://xsleaks.dev/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a>: same-origin</em>), which often must be combined to achieve the desired outcome.</p><p>We can distinguish different sources of XS-Leaks, such as:</p><ol><li>Browser APIs (e.g. <a href=https://xsleaks.dev/docs/attacks/frame-counting/>Frame Counting</a> and <a href=https://xsleaks.dev/docs/attacks/timing-attacks/>Timing Attacks</a>)</li><li>Browser implementation details and bugs (e.g. <a href=https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/>Connection Pooling</a> and <a href=https://xsleaks.dev/docs/attacks/historical/content-type/#typemustmatch>typeMustMatch</a>)</li><li>Hardware bugs (e.g. Speculative Execution Attacks <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>)</li></ol><h2 id=a-little-bit-of-history>A little bit of history
<a class=anchor href=#a-little-bit-of-history>#</a></h2><p>XS-Leaks have long been part of the web platform; <a href=https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/>timing attacks</a> to leak information about the user&rsquo;s web activity have been known since at least <a href=https://dl.acm.org/doi/10.1145/352600.352606>2000</a>.</p><p>This class of issues has steadily attracted more attention <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup> as new techniques were found to increase their impact. In 2015, Gelernter and Herzberg published &ldquo;Cross-Site Search Attacks&rdquo; <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup> which covered their work on exploiting timing attacks to implement high impact XS-Search attacks against web applications built by Google and Microsoft. Since then, more XS-Leak techniques have been discovered and tested.</p><p>Recently, browsers have implemented a variety of new <a href=https://xsleaks.dev/defenses/>defense mechanisms</a> that make it easier to protect applications from XS-Leaks.</p><h2 id=about-this-wiki>About this wiki
<a class=anchor href=#about-this-wiki>#</a></h2><p>This wiki is meant to both introduce readers to XS-Leaks and serve as a reference guide for experienced researchers exploiting XS-Leaks. While this wiki contains information on many different techniques, new techniques are always emerging. Improvements, whether they add new techniques or expand existing pages, are always appreciated!</p><p>Find out how you can contribute to this wiki and view the list of contributors in the <a href=https://xsleaks.dev/docs/contributions/>Contributions</a> article.</p><h2 id=references>References
<a class=anchor href=#references>#</a></h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Side Channel Vulnerabilities on the Web - Detection and Prevention, <a href=https://web.archive.org/web/20200924124054/https://owasp.org/www-pdf-archive/Side_Channel_Vulnerabilities.pdf>link</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>In some cases, these features are maintained to preserve backwards compatibility. But, in other cases, new features are added to browsers regardless of the fact that they introduce potential cross-site leaks (e.g. <a href=https://xsleaks.dev/docs/attacks/experiments/scroll-to-text-fragment/>Scroll to Text Fragment</a>), as the benefits are considered to outweigh the downsides.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Cross Site Request Forgery (CSRF), <a href=https://owasp.org/www-community/attacks/csrf>link</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Meltdown and Spectre, <a href=https://spectreattack.com/>link</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>Browser Side Channels, <a href=https://github.com/xsleaks/xsleaks/wiki/Browser-Side-Channels>link</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>Cross-Site Search Attacks, <a href=https://446h.cybersec.fun/xssearch.pdf>link</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/commit/0b8bbd1eb0692bb0fe6ce1402b49c2e954502d90 title='Last modified by Sandor Major | December 17, 2024' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Last Modified: December 17, 2024</span></a></div><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/edit/master/content/_index.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this article</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>